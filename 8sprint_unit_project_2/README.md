
# Описание проекта

Данные находятся в трёх файлах:

-   `gold_recovery_train_new.csv` — обучающая выборка;
-   `gold_recovery_test_new.csv` — тестовая выборка;
-   `gold_recovery_full_new.csv` — исходные данные.

Данные индексируются датой и временем получения информации (признак `date`). Соседние по времени параметры часто похожи.

Некоторые параметры недоступны, потому что замеряются и/или рассчитываются значительно позже. Из-за этого в тестовой выборке отсутствуют некоторые признаки, которые могут быть в обучающей. Также в тестовом наборе нет целевых признаков.

Исходный датасет содержит обучающую и тестовую выборки со всеми признаками.

В вашем распоряжении сырые данные: их просто выгрузили из хранилища. Прежде чем приступить к построению модели, проверьте по нашей инструкции их на корректность.

## Инструкция по выполнению проекта

**1. Подготовьте данные**

1.1. Откройте файлы и изучите их.

Путь к файлам:

-   _/datasets/gold_recovery_train_new.csv_. 
-   _/datasets/gold_recovery_test_new.csv_. 
-   _/datasets/gold_recovery_full_new.csv_. )

1.2. Проверьте, что эффективность обогащения рассчитана правильно. Вычислите её на обучающей выборке для признака `rougher.output.recovery`. Найдите _MAE_ между вашими расчётами и значением признака. Опишите выводы.

1.3. Проанализируйте признаки, недоступные в тестовой выборке. Что это за параметры? К какому типу относятся?

1.4. Проведите предобработку данных.

**2. Проанализируйте данные**

2.1. Посмотрите, как меняется концентрация металлов (_Au, Ag, Pb_) на различных этапах очистки. Опишите выводы.

2.2. Сравните распределения размеров гранул сырья на обучающей и тестовой выборках. Если распределения сильно отличаются друг от друга, оценка модели будет неправильной.

2.3. Исследуйте суммарную концентрацию всех веществ на разных стадиях: в сырье, в черновом и финальном концентратах.

**3. Постройте модель**

3.1. Напишите функцию для вычисления итоговой _sMAPE_.

3.2. Обучите разные модели и оцените их качество кросс-валидацией. Выберите лучшую модель и проверьте её на тестовой выборке. Опишите выводы.

Вам пригодятся формулы метрик качества:

![image](https://pictures.s3.yandex.net/resources/smape_1576239058.jpg)

![image](https://pictures.s3.yandex.net/resources/_smape_1576239054.jpg)

# Технологический процесс

Как золото получают из руды? Изучите внимательно стадии процесса.

Когда добытая руда проходит первичную обработку, получается дроблёная смесь. Её отправляют на флотацию (обогащение) и двухэтапную очистку.

![image](https://pictures.s3.yandex.net/resources/viruchka_1576238830.jpg)

Опишем каждую стадию:

**1. Флотация**

Во флотационную установку подаётся смесь золотосодержащей руды. После обогащения получается черновой концентрат и «отвальные хвосты», то есть остатки продукта с низкой концентрацией ценных металлов.

На стабильность этого процесса влияет непостоянное и неоптимальное физико-химическое состояние флотационной пульпы (смеси твёрдых частиц и жидкости).

**2. Очистка**

Черновой концентрат проходит две очистки. На выходе получается финальный концентрат и новые отвальные хвосты.

## Описание данных

**Технологический процесс**

-   _Rougher feed_ — исходное сырье
-   _Rougher additions_ (или _reagent additions_) — флотационные реагенты: _Xanthate, Sulphate, Depressant_
    -   _Xanthate_ — ксантогенат (промотер, или активатор флотации);
    -   _Sulphate_ — сульфат (на данном производстве сульфид натрия);
    -   _Depressant_ — депрессант (силикат натрия).
-   _Rougher process_ (англ. «грубый процесс») — флотация
-   _Rougher tails_ — отвальные хвосты
-   _Float banks_ — флотационная установка
-   _Cleaner process_ — очистка
-   _Rougher Au_ — черновой концентрат золота
-   _Final Au_ — финальный концентрат золота

**Параметры этапов**

-   _air amount_ — объём воздуха
-   _fluid levels_ — уровень жидкости
-   _feed size_ — размер гранул сырья
-   _feed rate_ — скорость подачи

## **Наименование признаков**

Наименование признаков должно быть такое:

`[этап].[тип_параметра].[название_параметра]`

Пример: `rougher.input.feed_ag`

Возможные значения для блока `[этап]`:

-   _rougher_ — флотация
-   _primary_cleaner_ — первичная очистка
-   _secondary_cleaner_ — вторичная очистка
-   _final_ — финальные характеристики

Возможные значения для блока `[тип_параметра]`:

-   _input_ — параметры сырья
-   _output_ — параметры продукта
-   _state_ — параметры, характеризующие текущее состояние этапа
-   _calculation_ — расчётные характеристики

## Расчёт эффективности

Вам нужно смоделировать процесс восстановления золота из золотосодержащей руды.

Эффективность обогащения рассчитывается по формуле

![image](https://pictures.s3.yandex.net/resources/Recovery_1576238822.jpg)

где:

-   _C_ — доля золота в концентрате после флотации/очистки;
-   _F_ — доля золота в сырье/концентрате до флотации/очистки;
-   _T_ — доля золота в отвальных хвостах после флотации/очистки.

Для прогноза коэффициента нужно найти долю золота в концентратах и хвостах. Причём важен не только финальный продукт, но и черновой концентрат.


Нужно спрогнозировать сразу две величины:

1.  эффективность обогащения чернового концентрата `rougher.output.recovery`;
    
2.  эффективность обогащения финального концентрата `final.output.recovery`.
    

